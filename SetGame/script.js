// 81 objects(cards)
let deck =[
   {
    shape: "rhombus",
    pattern: "outline",
    color: "red",
    number: 1,
    name: "oneOutlineRedRhombus"
  },
  {
    shape: "rhombus",
    pattern: "outline",
    color: "red",
    number: 2,
    name: "twoOutlineRedRhombus"
  },
   {
    shape: "rhombus",
    pattern: "outline",
    color: "red",
    number: 3,
    name: "threeOutlineRedRhombus"
  },
  {
    shape: "rhombus",
    pattern: "striped",
    color: "red",
    number: 1,
    name: "oneStripedRedRhombus"
  },
  {
    shape: "rhombus",
    pattern: "striped",
    color: "red",
    number: 2,
    name: "twoStripedRedRhombus"
  },
   {
    shape: "rhombus",
    pattern: "striped",
    color: "red",
    number: 3,
    name: "threeStripedRedRhombus"
  },
  {
    shape: "rhombus",
    pattern: "solid",
    color: "red",
    number: 1,
    name: "oneSolidRedRhombus"
  },
  {
    shape: "rhombus",
    pattern: "solid",
    color: "red",
    number: 2,
    name: "twoSolidRedRhombus"
  },
   {
    shape: "rhombus",
    pattern: "solid",
    color: "red",
    number: 3,
    name: "threeSolidRedRhombus"
  },
    {
    shape: "rhombus",
    pattern: "outline",
    color: "green",
    number: 1,
    name: "oneOutlineGreenRhombus"
  },
   {
    shape: "rhombus",
    pattern: "outline",
    color: "green",
    number: 2,
    name: "twoOutlineGreenRhombus"
  }, 
  {
    shape: "rhombus",
    pattern: "outline",
    color: "green",
    number: 3,
    name: "threeOutlineGreenRhombus"
  },
   {
    shape: "rhombus",
    pattern: "striped",
    color: "green",
    number: 1,
    name: "oneStripedGreenRhombus"
  },
   {
    shape: "rhombus",
    pattern: "striped",
    color: "green",
    number: 2,
    name: "twoStripedGreenRhombus"
  },
   {
    shape: "rhombus",
    pattern: "striped",
    color: "green",
    number: 3,
    name: "threeStripedGreenRhombus"
  },
   {
    shape: "rhombus",
    pattern: "solid",
    color: "green",
    number: 1,
    name: "oneSolidGreenRhombus"
  },
   {
    shape: "rhombus",
    pattern: "solid",
    color: "green",
    number: 2,
    name: "twoSolidGreenRhombus"
  }, {
    shape: "rhombus",
    pattern: "solid",
    color: "green",
    number: 3,
    name: "threeSolidGreenRhombus"
  },
   {
    shape: "rhombus",
    pattern: "outline",
    color: "blue",
    number: 1,
    name: "oneOutlineBlueRhombus"
  },
  {
    shape: "rhombus",
    pattern: "outline",
    color: "blue",
    number: 2,
    name: "twoOutlineBlueRhombus"
  },
  {
    shape: "rhombus",
    pattern: "outline",
    color: "blue",
    number: 3,
    name: "threeOutlineBlueRhombus"
  },
  {
    shape: "rhombus",
    pattern: "striped",
    color: "blue",
    number: 1,
    name: "oneStripedBlueRhombus"
  },
  {
    shape: "rhombus",
    pattern: "striped",
    color: "blue",
    number: 2,
    name: "twoStripedBlueRhombus"
  },
  {
    shape: "rhombus",
    pattern: "striped",
    color: "blue",
    number: 3,
    name: "threeStripedBlueRhombus"
  },
    {
    shape: "rhombus",
    pattern: "solid",
    color: "blue",
    number: 1,
    name: "oneSolidBlueRhombus"
  },
    {
    shape: "rhombus",
    pattern: "solid",
    color: "blue",
    number: 2,
    name: "twoSolidBlueRhombus"
  },
    {
    shape: "rhombus",
    pattern: "solid",
    color: "blue",
    number: 3,
    name: "threeSolidBlueRhombus"
  },
  {
    shape: "pill",
    pattern: "outline",
    color: "red",
    number: 1,
    name: "oneOutlineRedPill"
  },
   {
    shape: "pill",
    pattern: "outline",
    color: "red",
    number: 2,
    name: "twoOutlineRedPill"
  },
   {
    shape: "pill",
    pattern: "outline",
    color: "red",
    number: 3,
    name: "threeOutlineRedPill"
  },
   {
    shape: "pill",
    pattern: "striped",
    color: "red",
    number: 1,
    name: "oneStripedRedPill"
  }, {
    shape: "pill",
    pattern: "striped",
    color: "red",
    number: 2,
    name: "twoStripedRedPill"
  },
   {
    shape: "pill",
    pattern: "striped",
    color: "red",
    number: 3,
    name: "threeStripedRedPill"
  },
   {
    shape: "pill",
    pattern: "solid",
    color: "red",
    number: 1,
    name: "oneSolidRedPill"
  },
   {
    shape: "pill",
    pattern: "solid",
    color: "red",
    number: 2,
    name: "twoSolidRedPill"
  },
   {
    shape: "pill",
    pattern: "solid",
    color: "red",
    number: 3,
    name: "threeSolidRedPill"
  },
   {
    shape: "pill",
    pattern: "outline",
    color: "green",
    number: 1,
    name: "oneOutlineGreenPill"
  },
   {
    shape: "pill",
    pattern: "outline",
    color: "green",
    number: 2,
    name: "twoOutlineGreenPill"
  },
   {
    shape: "pill",
    pattern: "outline",
    color: "green",
    number: 3,
    name: "threeOutlineGreenPill"
  },
   {
    shape: "pill",
    pattern: "striped",
    color: "green",
    number: 1,
    name: "oneStripedGreenPill"
  },
   {
    shape: "pill",
    pattern: "striped",
    color: "green",
    number: 2,
    name: "twoStripedGreenPill"
  },
   {
    shape: "pill",
    pattern: "striped",
    color: "green",
    number: 3,
    name: "threeStripedGreenPill"
  },
   {
    shape: "pill",
    pattern: "solid",
    color: "green",
    number: 1,
    name: "oneSolidGreenPill"
  },
  {
    shape: "pill",
    pattern: "solid",
    color: "green",
    number: 2,
    name: "twoSolidGreenPill"
  },
  {
    shape: "pill",
    pattern: "solid",
    color: "green",
    number: 3,
    name: "threeSolidGreenPill"
  },
  {
    shape: "pill",
    pattern: "outline",
    color: "blue",
    number: 1,
    name: "oneOutlineBluePill"
  },
  {
    shape: "pill",
    pattern: "outline",
    color: "blue",
    number: 2,
    name: "twoOutlineBluePill"
  },
  {
    shape: "pill",
    pattern: "outline",
    color: "blue",
    number: 3,
    name: "threeOutlineBluePill"
  },
  {
    shape: "pill",
    pattern: "striped",
    color: "blue",
    number: 1,
    name: "oneStripedBluePill"
  },
   {
    shape: "pill",
    pattern: "striped",
    color: "blue",
    number: 2,
    name: "twoStripedBluePill"
  },
   {
    shape: "pill",
    pattern: "striped",
    color: "blue",
    number: 3,
    name: "threeStripedBluePill"
  },
   {
    shape: "pill",
    pattern: "solid",
    color: "blue",
    number: 1,
    name: "oneSolidBluePill"
  },
   {
    shape: "pill",
    pattern: "solid",
    color: "blue",
    number: 2,
    name: "twoSolidBluePill"
  }, {
    shape: "pill",
    pattern: "solid",
    color: "blue",
    number: 3,
    name: "threeSolidBluePill"
  },
   {
    shape: "chevron",
    pattern: "outline",
    color: "red",
    number: 1,
    name: "oneOutlineRedChevron"
  },
    {
    shape: "chevron",
    pattern: "outline",
    color: "red",
    number: 2,
    name: "twoOutlineRedChevron"
  },
    {
    shape: "chevron",
    pattern: "outline",
    color: "red",
    number: 3,
    name: "threeOutlineRedChevron"
  },
    {
    shape: "chevron",
    pattern: "striped",
    color: "red",
    number: 1,
    name: "oneStripedRedChevron"
  },
   {
    shape: "chevron",
    pattern: "striped",
    color: "red",
    number: 2,
    name: "twoStripedRedChevron"
  },
   {
    shape: "chevron",
    pattern: "striped",
    color: "red",
    number: 3,
    name: "threeStripedRedChevron"
  },
   {
    shape: "chevron",
    pattern: "solid",
    color: "red",
    number: 1,
    name: "oneSolidRedChevron"
  },
     {
    shape: "chevron",
    pattern: "solid",
    color: "red",
    number: 2,
    name: "twoSolidRedChevron"
  },
     {
    shape: "chevron",
    pattern: "solid",
    color: "red",
    number: 3,
    name: "threeSolidRedChevron"
  },
     {
    shape: "chevron",
    pattern: "outline",
    color: "green",
    number: 1,
    name: "oneOutlineGreenChevron"
  },
   {
    shape: "chevron",
    pattern: "outline",
    color: "green",
    number: 2,
    name: "twoOutlineGreenChevron"
  },
   {
    shape: "chevron",
    pattern: "outline",
    color: "green",
    number: 3,
    name: "threeOutlineGreenChevron"
  },
   {
    shape: "chevron",
    pattern: "striped",
    color: "green",
    number: 1,
    name: "oneStripedGreenChevron"
  },
  {
    shape: "chevron",
    pattern: "striped",
    color: "green",
    number: 2,
    name: "twoStripedGreenChevron"
  },{
    shape: "chevron",
    pattern: "striped",
    color: "green",
    number: 3,
    name: "threeStripedGreenChevron"
  },
  {
    shape: "chevron",
    pattern: "solid",
    color: "green",
    number: 1,
    name: "oneSolidGreenChevron"
  },
   {
    shape: "chevron",
    pattern: "solid",
    color: "green",
    number: 2,
    name: "twoSolidGreenChevron"
  },
   {
    shape: "chevron",
    pattern: "solid",
    color: "green",
    number: 3,
    name: "threeSolidGreenChevron"
  },
  {
    shape: "chevron",
    pattern: "outline",
    color: "blue",
    number: 1,
    name: "oneOutlineBlueChevron"
  },
   {
    shape: "chevron",
    pattern: "outline",
    color: "blue",
    number: 2,
    name: "twoOutlineBlueChevron"
  },
   {
    shape: "chevron",
    pattern: "outline",
    color: "blue",
    number: 3,
    name: "threeOutlineBlueChevron"
  },
   {
    shape: "chevron",
    pattern: "striped",
    color: "blue",
    number: 1,
    name: "oneStripedBlueChevron"
  },
   {
    shape: "chevron",
    pattern: "striped",
    color: "blue",
    number: 2,
    name: "twoStripedBlueChevron"
  },
   {
    shape: "chevron",
    pattern: "striped",
    color: "blue",
    number: 3,
    name: "threeStripedBlueChevron"
  },
   {
    shape: "chevron",
    pattern: "solid",
    color: "blue",
    number: 1,
    name: "oneSolidBlueChevron"
  },
   {
    shape: "chevron",
    pattern: "solid",
    color: "blue",
    number: 2,
    name: "twoSolidBlueChevron"
  },
   {
    shape: "chevron",
    pattern: "solid",
    color: "blue",
    number: 3,
    name: "threeSolidBlueChevron"
  },
];
let selectedCards =[] //3 cards that were clicked on
let board = []; //12 or 15 cards on the board (3x4 grid)
let takenCards =[]; // cards that were verified that are no longer playable
let points = 0; // player's points, 1 set = 1 point, 1 wrong set = -1point
let initial = true; // initial deal is 12 cards, otherwise just 3
const cardNodeList = document.querySelectorAll(".card"); //get all card elements on board


function dealCards(){ //takes cards from deck and adds them to board array
let x = 0;
    if(initial == true){
//take a random index from the deck 12 times and add it to the board array
let chosen;
while(x < 12){
    chosen = Math.floor((Math.random() * deck.length ))
//console.log(chosen)
    board.push(deck[chosen]) //random index values from 0 to 81
deck.splice(chosen, 1) // removes one random object from the deck
initial = false;
assignBoard();
x++;
}

}else{
//take a random index from the deck 3 times and add it to the board array
for(let i=0; i < 3; i++){
chosen = Math.floor((Math.random() * deck.length ))
board.push(deck[chosen]) //random index values from 0 to 81
deck.splice(chosen, 1) // removes one random object from the deck
console.log("Currently on the board: " + board)
console.log("Deck Length: " + deck.length)

}
}

};
function assignBoard(){ //displays cards on html
   for(let i=0 ; i < board.length ; i++){
    let x=0;
    let childArray =  Array.from(cardNodeList[i].children); // one two three
    while (x < board[i].number){
       childArray[x].style.display ="flex";
       childArray[x].classList.add(board[i].shape, board[i].pattern);
       childArray[x].style.setProperty('--this-card-color', `var(--${board[i].color})`);
       cardNodeList[i].setAttribute('id', board[i].name);
    
x++;
    }
    x= 0;
}   
};


function removeValidSet(takenArr){
  for (let x=0; x<board.length ;x++){ //length = 12
    let childrenArr = Array.from(cardNodeList[x].children)
    for(let i=0; i < takenArr.length ; i++){
  if(board[x].name == takenArr[i].id){
    let index =board.indexOf(takenArr[i].id)
board.splice(index, 1)
if (cardNodeList[x].id == takenArr[i].id){
  for(let y=0 ; y<childrenArr.length; y++){
    const classesToRemove = ['rhombus', 'pill','chevron','solid','striped','outline']
    
    for (const className of classesToRemove){
      childrenArr[y].classList.remove(className);  
    }
childrenArr[y].style.display ='none';
  }
  cardNodeList[x].removeAttribute('id')
}
}
    }
  }
  console.log(board.length)
}
function verifySet(){
  
//compare all three cards to each other
// consider each characteristic one at a time
//if two share a characteristic and the last one does not then it is not a set
const cardZeroChildren = Array.from(selectedCards[0].children) // one two three;
const cardOneChildren =Array.from(selectedCards[1].children) // one two three;
const cardTwoChildren =Array.from(selectedCards[2].children) // one two three;

if (
  haveSameClassShape(cardZeroChildren[0],cardOneChildren[0]) == haveSameClassShape(cardZeroChildren[0],cardTwoChildren[0])&& // shape
  haveSameClassPattern(cardZeroChildren[0],cardOneChildren[0]) == haveSameClassPattern(cardZeroChildren[0],cardTwoChildren[0])&&  //pattern
  haveSameColor(cardZeroChildren[0],cardOneChildren[0]) == haveSameColor(cardZeroChildren[0],cardTwoChildren[0])&& //color
  haveSameNumber(cardZeroChildren,cardOneChildren) == haveSameNumber(cardZeroChildren,cardTwoChildren)) { // number

  console.log("This IS a set");
    //console.log(cardZeroChildren[0].classList)
    //  console.log(cardOneChildren[0].classList)
      
for(let i=0; i< 3 ; i++){
takenCards.push(selectedCards[i]) // adds valid set to taken cards array
//console.log(takenCards)
  }
  removeValidSet(takenCards);
} else{
    console.log("this is NOT a set");
    for( let x=0; x <selectedCards.length; x++){
      selectedCards[x].style.border = 'none';
    }
    selectedCards = [];
    }
}

//adds the clicked on cards to the array of selected cards and verifies them
function addToSelectedCardsArr(){
  cardNodeList.forEach(item => {
  item.addEventListener('click', () => {
    if(selectedCards.length < 3 && !selectedCards.includes(item)){ 
      selectedCards.push(item);
      item.style.border = "2px solid blue";
    }
     console.log(selectedCards);
     verifySet();
  });
  



});

}
function haveSameClassShape(element1, element2){
 const classList1 = element1.classList;
  const classList2 = element2.classList;
    const classShape = classList1[1];
    // Check if the current class exists in the second element's class list
    if (classList2[1] == classShape) {
       return true// Found a common class
    }else{
 return false// No common classes found
    }
  
}
function haveSameClassPattern(element1, element2){
 const classList1 = element1.classList;
  const classList2 = element2.classList;
    const classPattern = classList1[2];
    // Check if the current class exists in the second element's class list
    if (classList2[2]== classPattern) {
  
       return true// Found a common class
    }else{
 return false// No common classes found
    }
  
}
function haveSameColor(element1, element2){
const color1 = element1.style.getPropertyValue('--this-card-color');
const color2 = element2.style.getPropertyValue('--this-card-color');
if (color1 == color2){
  console.log(color1)
  console.log(color2)
  return true
}else{
  return false
}

}
function haveSameNumber(array1, array2){
  let totalDisplay1 = 0;
  let totalDisplay2 = 0;
for (let x=0; x< 3 ; x++){
  if (array1[x].style.display == 'flex'){
    totalDisplay1 +=1;
  }
   if (array2[x].style.display == 'flex'){
    totalDisplay2 +=1;
  }
}
if (totalDisplay1 == totalDisplay2){
  return true
}else{
  return false
}
}
function deselect(card){ //unfinished
  let sIndex = selectedCards.indexOf(card)
  selectedCards.splice(sIndex, 1);
}


//function calls-----------------------------------------------
dealCards();
addToSelectedCardsArr()


