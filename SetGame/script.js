// 81 objects(cards)
let deck =[
   {
    shape: "rhombus",
    pattern: "outline",
    color: "red",
    number: 1,
    name: "oneOutlineRedRhombus"
  },
  {
    shape: "rhombus",
    pattern: "outline",
    color: "red",
    number: 2,
    name: "twoOutlineRedRhombus"
  },
   {
    shape: "rhombus",
    pattern: "outline",
    color: "red",
    number: 3,
    name: "threeOutlineRedRhombus"
  },
  {
    shape: "rhombus",
    pattern: "striped",
    color: "red",
    number: 1,
    name: "oneStripedRedRhombus"
  },
  {
    shape: "rhombus",
    pattern: "striped",
    color: "red",
    number: 2,
    name: "twoStripedRedRhombus"
  },
   {
    shape: "rhombus",
    pattern: "striped",
    color: "red",
    number: 3,
    name: "threeStripedRedRhombus"
  },
  {
    shape: "rhombus",
    pattern: "solid",
    color: "red",
    number: 1,
    name: "oneSolidRedRhombus"
  },
  {
    shape: "rhombus",
    pattern: "solid",
    color: "red",
    number: 2,
    name: "twoSolidRedRhombus"
  },
   {
    shape: "rhombus",
    pattern: "solid",
    color: "red",
    number: 3,
    name: "threeSolidRedRhombus"
  },
    {
    shape: "rhombus",
    pattern: "outline",
    color: "green",
    number: 1,
    name: "oneOutlineGreenRhombus"
  },
   {
    shape: "rhombus",
    pattern: "outline",
    color: "green",
    number: 2,
    name: "twoOutlineGreenRhombus"
  }, 
  {
    shape: "rhombus",
    pattern: "outline",
    color: "green",
    number: 3,
    name: "threeOutlineGreenRhombus"
  },
   {
    shape: "rhombus",
    pattern: "striped",
    color: "green",
    number: 1,
    name: "oneStripedGreenRhombus"
  },
   {
    shape: "rhombus",
    pattern: "striped",
    color: "green",
    number: 2,
    name: "twoStripedGreenRhombus"
  },
   {
    shape: "rhombus",
    pattern: "striped",
    color: "green",
    number: 3,
    name: "threeStripedGreenRhombus"
  },
   {
    shape: "rhombus",
    pattern: "solid",
    color: "green",
    number: 1,
    name: "oneSolidGreenRhombus"
  },
   {
    shape: "rhombus",
    pattern: "solid",
    color: "green",
    number: 2,
    name: "twoSolidGreenRhombus"
  }, {
    shape: "rhombus",
    pattern: "solid",
    color: "green",
    number: 3,
    name: "threeSolidGreenRhombus"
  },
   {
    shape: "rhombus",
    pattern: "outline",
    color: "blue",
    number: 1,
    name: "oneOutlineBlueRhombus"
  },
  {
    shape: "rhombus",
    pattern: "outline",
    color: "blue",
    number: 2,
    name: "twoOutlineBlueRhombus"
  },
  {
    shape: "rhombus",
    pattern: "outline",
    color: "blue",
    number: 3,
    name: "threeOutlineBlueRhombus"
  },
  {
    shape: "rhombus",
    pattern: "striped",
    color: "blue",
    number: 1,
    name: "oneStripedBlueRhombus"
  },
  {
    shape: "rhombus",
    pattern: "striped",
    color: "blue",
    number: 2,
    name: "twoStripedBlueRhombus"
  },
  {
    shape: "rhombus",
    pattern: "striped",
    color: "blue",
    number: 3,
    name: "threeStripedBlueRhombus"
  },
    {
    shape: "rhombus",
    pattern: "solid",
    color: "blue",
    number: 1,
    name: "oneSolidBlueRhombus"
  },
    {
    shape: "rhombus",
    pattern: "solid",
    color: "blue",
    number: 2,
    name: "twoSolidBlueRhombus"
  },
    {
    shape: "rhombus",
    pattern: "solid",
    color: "blue",
    number: 3,
    name: "threeSolidBlueRhombus"
  },
  {
    shape: "pill",
    pattern: "outline",
    color: "red",
    number: 1,
    name: "oneOutlineRedPill"
  },
   {
    shape: "pill",
    pattern: "outline",
    color: "red",
    number: 2,
    name: "twoOutlineRedPill"
  },
   {
    shape: "pill",
    pattern: "outline",
    color: "red",
    number: 3,
    name: "threeOutlineRedPill"
  },
   {
    shape: "pill",
    pattern: "striped",
    color: "red",
    number: 1,
    name: "oneStripedRedPill"
  }, {
    shape: "pill",
    pattern: "striped",
    color: "red",
    number: 2,
    name: "twoStripedRedPill"
  },
   {
    shape: "pill",
    pattern: "striped",
    color: "red",
    number: 3,
    name: "threeStripedRedPill"
  },
   {
    shape: "pill",
    pattern: "solid",
    color: "red",
    number: 1,
    name: "oneSolidRedPill"
  },
   {
    shape: "pill",
    pattern: "solid",
    color: "red",
    number: 2,
    name: "twoSolidRedPill"
  },
   {
    shape: "pill",
    pattern: "solid",
    color: "red",
    number: 3,
    name: "threeSolidRedPill"
  },
   {
    shape: "pill",
    pattern: "outline",
    color: "green",
    number: 1,
    name: "oneOutlineGreenPill"
  },
   {
    shape: "pill",
    pattern: "outline",
    color: "green",
    number: 2,
    name: "twoOutlineGreenPill"
  },
   {
    shape: "pill",
    pattern: "outline",
    color: "green",
    number: 3,
    name: "threeOutlineGreenPill"
  },
   {
    shape: "pill",
    pattern: "striped",
    color: "green",
    number: 1,
    name: "oneStripedGreenPill"
  },
   {
    shape: "pill",
    pattern: "striped",
    color: "green",
    number: 2,
    name: "twoStripedGreenPill"
  },
   {
    shape: "pill",
    pattern: "striped",
    color: "green",
    number: 3,
    name: "threeStripedGreenPill"
  },
   {
    shape: "pill",
    pattern: "solid",
    color: "green",
    number: 1,
    name: "oneSolidGreenPill"
  },
  {
    shape: "pill",
    pattern: "solid",
    color: "green",
    number: 2,
    name: "twoSolidGreenPill"
  },
  {
    shape: "pill",
    pattern: "solid",
    color: "green",
    number: 3,
    name: "threeSolidGreenPill"
  },
  {
    shape: "pill",
    pattern: "outline",
    color: "blue",
    number: 1,
    name: "oneOutlineBluePill"
  },
  {
    shape: "pill",
    pattern: "outline",
    color: "blue",
    number: 2,
    name: "twoOutlineBluePill"
  },
  {
    shape: "pill",
    pattern: "outline",
    color: "blue",
    number: 3,
    name: "threeOutlineBluePill"
  },
  {
    shape: "pill",
    pattern: "striped",
    color: "blue",
    number: 1,
    name: "oneStripedBluePill"
  },
   {
    shape: "pill",
    pattern: "striped",
    color: "blue",
    number: 2,
    name: "twoStripedBluePill"
  },
   {
    shape: "pill",
    pattern: "striped",
    color: "blue",
    number: 3,
    name: "threeStripedBluePill"
  },
   {
    shape: "pill",
    pattern: "solid",
    color: "blue",
    number: 1,
    name: "oneSolidBluePill"
  },
   {
    shape: "pill",
    pattern: "solid",
    color: "blue",
    number: 2,
    name: "twoSolidBluePill"
  }, {
    shape: "pill",
    pattern: "solid",
    color: "blue",
    number: 3,
    name: "threeSolidBluePill"
  },
   {
    shape: "chevron",
    pattern: "outline",
    color: "red",
    number: 1,
    name: "oneOutlineRedChevron"
  },
    {
    shape: "chevron",
    pattern: "outline",
    color: "red",
    number: 2,
    name: "twoOutlineRedChevron"
  },
    {
    shape: "chevron",
    pattern: "outline",
    color: "red",
    number: 3,
    name: "threeOutlineRedChevron"
  },
    {
    shape: "chevron",
    pattern: "striped",
    color: "red",
    number: 1,
    name: "oneStripedRedChevron"
  },
   {
    shape: "chevron",
    pattern: "striped",
    color: "red",
    number: 2,
    name: "twoStripedRedChevron"
  },
   {
    shape: "chevron",
    pattern: "striped",
    color: "red",
    number: 3,
    name: "threeStripedRedChevron"
  },
   {
    shape: "chevron",
    pattern: "solid",
    color: "red",
    number: 1,
    name: "oneSolidRedChevron"
  },
     {
    shape: "chevron",
    pattern: "solid",
    color: "red",
    number: 2,
    name: "twoSolidRedChevron"
  },
     {
    shape: "chevron",
    pattern: "solid",
    color: "red",
    number: 3,
    name: "threeSolidRedChevron"
  },
     {
    shape: "chevron",
    pattern: "outline",
    color: "green",
    number: 1,
    name: "oneOutlineGreenChevron"
  },
   {
    shape: "chevron",
    pattern: "outline",
    color: "green",
    number: 2,
    name: "twoOutlineGreenChevron"
  },
   {
    shape: "chevron",
    pattern: "outline",
    color: "green",
    number: 3,
    name: "threeOutlineGreenChevron"
  },
   {
    shape: "chevron",
    pattern: "striped",
    color: "green",
    number: 1,
    name: "oneStripedGreenChevron"
  },
  {
    shape: "chevron",
    pattern: "striped",
    color: "green",
    number: 2,
    name: "twoStripedGreenChevron"
  },{
    shape: "chevron",
    pattern: "striped",
    color: "green",
    number: 3,
    name: "threeStripedGreenChevron"
  },
  {
    shape: "chevron",
    pattern: "solid",
    color: "green",
    number: 1,
    name: "oneSolidGreenChevron"
  },
   {
    shape: "chevron",
    pattern: "solid",
    color: "green",
    number: 2,
    name: "twoSolidGreenChevron"
  },
   {
    shape: "chevron",
    pattern: "solid",
    color: "green",
    number: 3,
    name: "threeSolidGreenChevron"
  },
  {
    shape: "chevron",
    pattern: "outline",
    color: "blue",
    number: 1,
    name: "oneOutlineBlueChevron"
  },
   {
    shape: "chevron",
    pattern: "outline",
    color: "blue",
    number: 2,
    name: "twoOutlineBlueChevron"
  },
   {
    shape: "chevron",
    pattern: "outline",
    color: "blue",
    number: 3,
    name: "threeOutlineBlueChevron"
  },
   {
    shape: "chevron",
    pattern: "striped",
    color: "blue",
    number: 1,
    name: "oneStripedBlueChevron"
  },
   {
    shape: "chevron",
    pattern: "striped",
    color: "blue",
    number: 2,
    name: "twoStripedBlueChevron"
  },
   {
    shape: "chevron",
    pattern: "striped",
    color: "blue",
    number: 3,
    name: "threeStripedBlueChevron"
  },
   {
    shape: "chevron",
    pattern: "solid",
    color: "blue",
    number: 1,
    name: "oneSolidBlueChevron"
  },
   {
    shape: "chevron",
    pattern: "solid",
    color: "blue",
    number: 2,
    name: "twoSolidBlueChevron"
  },
   {
    shape: "chevron",
    pattern: "solid",
    color: "blue",
    number: 3,
    name: "threeSolidBlueChevron"
  },
];
let selectedCards =[] //3 cards that were clicked on
let board = []; //12 or 15 cards on the board (3x4 grid)
let takenCards =[]; // cards that were verified that are no longer playable
let points = 0; // player's points, 1 set = 1 point, 1 wrong set = -1point
let initial = true; // initial deal is 12 cards, otherwise just 3
const cardNodeList = document.querySelectorAll(".card"); //get all card elements on board
const playerPointsSpanElement = document.getElementById("points");
const timerSpanElement = document.getElementById("timer");
const foundCounterElement = document.getElementById("found");
const addCardsElement = document.querySelector("#add-cards");
const gridContainerElement = document.querySelector(".board-wrapper");
const newSpot1 = document.querySelector(".m");
const newSpot2 = document.querySelector(".n");
const newSpot3 = document.querySelector(".o");
//stats variables
let setCounter = 0;
const donughtChart = document.querySelector("#doughnut-chart");
let identicalData = 0;
let balancedData = 0;
let singleData= 0 ;
let rainbowData= 0;
const endingChart = document.querySelector("#ending-chart");
//sounds
const validSound = document.getElementById("valid-sound");
const invalidSound = document.getElementById("invalid-sound");
const finishSound = document.getElementById("finish-sound");

// rules popup stuff
const ruleDialog = document.getElementById("rules");
const goButton = document.getElementById("go");
const overDialog = document.getElementById("game-over");
const retryButton = document.getElementById("retry");

ruleDialog.showModal();
function closeRules(){
  ruleDialog.close();
  startTimer();
}
//quit button function
function quitting(){
  stopTimer();
  finishSound.play();
  lastChart.data.datasets[0].data =[identicalData, balancedData, singleData, rainbowData];
lastChart.update();
  overDialog.showModal();
  
}
function retryGame(){
  window.location.reload();
}
retryButton.addEventListener("click", retryGame);
goButton.addEventListener("click",closeRules);


function dealCards(){ //takes cards from deck and adds them to board array
let x = 0;
    if(initial == true){
//take a random index from the deck 12 times and add it to the board array
let chosen;
while(x < 12){
    chosen = Math.floor((Math.random() * deck.length ))
    board.push(deck[chosen]) //random index values from 0 to 81
deck.splice(chosen, 1) // removes one random object from the deck
assignBoardInitial();
;
x++;
}

}else{
//take a random index from the deck 3 times and add it to the board array
if(board.length < 15){
for(let i=0; i < 3; i++){
chosen = Math.floor((Math.random() * deck.length ))
board.push(deck[chosen]) //random index values from 0 to 81
deck.splice(chosen, 1) // removes one random object from the deck

}

}else{
  console.log("too many cards already")
}

console.log("Currently on the board: " , board)
assignBoardContinued();
}
  if(board.length ==15){
    //adds a new row with 3 cols
      let currentGridAreas = getComputedStyle(gridContainerElement).gridTemplateAreas;
      const newRowAreas = 'm n o';
  let gridAreasArray = currentGridAreas.match(/"([^"]+)"/g).map(r => r.replace(/"/g, '')); // gets quotes in the string that matches the regex value for quotations globally, then returns a new array that replaces every quotation with an empty string
     gridAreasArray.push(newRowAreas);
const newGridTemplateAreas = gridAreasArray.map(row => `"${row}"`).join('\n');
gridContainerElement.style.gridTemplateAreas = newGridTemplateAreas;
// display the 3 spots

newSpot1.style.display = "flex";
newSpot2.style.display = "flex";
newSpot3.style.display = "flex";
  console.log(newGridTemplateAreas);
  console.log(board.length)
}
};

function assignBoardInitial(){ //displays cards on html
  if (initial == true){
 for(let i=0 ; i < board.length ; i++){
    let x=0;
    let childArray =  Array.from(cardNodeList[i].children); // one two three
    while (x < board[i].number){
       childArray[x].style.display ="flex";
       childArray[x].classList.add(board[i].shape, board[i].pattern);
       childArray[x].style.setProperty('--this-card-color', `var(--${board[i].color})`);
       cardNodeList[i].setAttribute('id', board[i].name);
    
x++;
    }
    x= 0;
}   

  }
 
};

function assignBoardContinued(){
  let noIDCards=[] ; // 3 cards in this array without ids
  for(let i=0 ; i<cardNodeList.length; i++){
    if (cardNodeList[i].hasAttribute('id')){}else{
      noIDCards.push(cardNodeList[i]);

    }
  }
  console.log("cards without ids: " , noIDCards)
  for (let x=0; x<noIDCards.length; x++){
   let boardIndex = (board.length -3)+x;
    noIDCards[x].id = board[boardIndex].name;
    let childArray = Array.from(noIDCards[x].children);
    for (let y=0; y< board[boardIndex].number; y++){
      childArray[y].style.display ="flex";
      childArray[y].classList.add(board[boardIndex].shape, board[boardIndex].pattern);
      childArray[y].style.setProperty('--this-card-color', `var(--${board[boardIndex].color})`);
    }
    } 
    console.log(noIDCards);
   

};
function checkSimilarity(int){
 if (int == 3){
identicalData +=1;

console.log("identical set count" + identicalData);
  }
  else if (int == 2){
balancedData +=1;
console.log("balanced set count" + balancedData);
  }else if(int == 1){
singleData+=1;
console.log("single set count" + singleData);
  }else{
    //every trait is different
    rainbowData+=1;
    console.log("raindbow set count" + rainbowData);
  }
myChart.data.datasets[0].data = [identicalData, balancedData, singleData, rainbowData];
myChart.update();
}
function kindOfSet(child1, child2, child3, array1, array2, array3){
  let similarityCounter = 0;
  //compare color
  if(haveSameClassPattern(child1,child2, child3)[1] ==true){
    similarityCounter++;
  }
  if(haveSameClassShape(child1,child2, child3)[1] ==true){
    similarityCounter ++;
  }
  if(haveSameColor(child1,child2, child3)[1] == true){
similarityCounter ++;
  }
  if(haveSameNumber(array1,array2,array3)[1]==true){
similarityCounter ++;
  }
  console.log(similarityCounter)
  checkSimilarity(similarityCounter);
 
}
function removeValidSet(takenArr) {
  
  // First, collect all the card names to remove
  const cardNamesToRemove = [];
  
  for (let i = 0; i < takenArr.length; i++) {
    const takenCardId = takenArr[i].id;
    cardNamesToRemove.push(takenCardId);

    // Find the matching DOM card and remove styles
    for (let x = 0; x < cardNodeList.length; x++) {
      
      if (cardNodeList[x].id === takenCardId) {
        const childrenArr = Array.from(cardNodeList[x].children);

        for (let y = 0; y < childrenArr.length; y++) {
          const classesToRemove = ['rhombus', 'pill', 'chevron', 'solid', 'striped', 'outline'];
          for (const className of classesToRemove) {
            childrenArr[y].classList.remove(className);
          }
          childrenArr[y].style.display = 'none';
        }

        cardNodeList[x].removeAttribute('id');
      }
    }
  }
  
  // NOW remove all the cards from the board array at once
  for (let i = 0; i < cardNamesToRemove.length; i++) {
    const index = board.findIndex(card => card.name === cardNamesToRemove[i]);
    if (index !== -1) {
      board.splice(index, 1);
    }
  }

  // Remove border from selected cards
  for(let z = 0; z < selectedCards.length; z++){
    selectedCards[z].style.border = 'none';
  }
  selectedCards = []; // resets the selected cards arr
  
  takenCards = [];

  // Deal new cards BEFORE reorganizing (if board is less than 12)
  if(board.length < 12 && deck.length > 0){
    let cardsNeeded = Math.min(3, 12 - board.length);
    for(let i = 0; i < cardsNeeded; i++){
      let chosen = Math.floor((Math.random() * deck.length));
      board.push(deck[chosen]);
      deck.splice(chosen, 1);
    }
  }

  // Move cards to fill empty spots
  reorganizeBoard();
}

function reorganizeBoard() {
  // Clear all card displays first
  for(let i = 0; i < cardNodeList.length; i++) {
    const childrenArr = Array.from(cardNodeList[i].children);
    for(let y = 0; y < childrenArr.length; y++) {
      const classesToRemove = ['rhombus', 'pill', 'chevron', 'solid', 'striped', 'outline'];
      for (const className of classesToRemove) {
        childrenArr[y].classList.remove(className);
      }
      childrenArr[y].style.display = 'none';
    }
    cardNodeList[i].removeAttribute('id');
  }

  // Redistribute all board cards to the DOM elements
  for(let i = 0; i < board.length; i++) {
    const card = board[i];
    const domCard = cardNodeList[i];
    
    domCard.id = card.name;
    const childArray = Array.from(domCard.children);
    
    for(let j = 0; j < card.number; j++) {
      childArray[j].style.display = "flex";
      childArray[j].classList.add(card.shape, card.pattern);
      childArray[j].style.setProperty('--this-card-color', `var(--${card.color})`);
    }
  }

  // Adjust grid layout based on board length
  if(board.length <= 12) {
    gridContainerElement.style.gridTemplateAreas = `
      'a b c d'
      'e f g h'
      'i j k l'
    `;
    newSpot1.style.display = "none";
    newSpot2.style.display = "none";
    newSpot3.style.display = "none";
  } else {
    // Keep 5th row visible if we have 13-15 cards
    newSpot1.style.display = "flex";
    newSpot2.style.display = "flex";
    newSpot3.style.display = "flex";
  }
}
function verifySet(){
  
//if two share a characteristic and the last one does not then it is not a set
const cardZeroChildren = Array.from(selectedCards[0].children) // one two three;
const cardOneChildren =Array.from(selectedCards[1].children) // one two three;
const cardTwoChildren =Array.from(selectedCards[2].children) // one two three;

if (
  haveSameClassShape(cardZeroChildren[0],cardOneChildren[0],cardTwoChildren[0])[0] && // shape
  haveSameClassPattern(cardZeroChildren[0],cardOneChildren[0],cardTwoChildren[0])[0]&&  //pattern
  haveSameColor(cardZeroChildren[0],cardOneChildren[0],cardTwoChildren[0])[0]&& //color
  haveSameNumber(cardZeroChildren,cardOneChildren,cardTwoChildren)[0]) { // number
  console.log("This IS a set");
      points +=1;
      playerPointsSpanElement.innerText = points;
      setCounter += 3;
      foundCounterElement.innerText = setCounter;
      validSound.play();

for(let i=0; i< 3 ; i++){
takenCards.push(selectedCards[i]) // adds valid set to taken cards array
  }
  kindOfSet(cardZeroChildren[0],cardOneChildren[0],cardTwoChildren[0],cardZeroChildren,cardOneChildren,cardTwoChildren);
  removeValidSet(takenCards); // removes the taken cards from the board
takenCards =[];
//replace taken cards on the board

} else{
    console.log("this is NOT a set");
    points -=1;
    playerPointsSpanElement.innerText = points;
    invalidSound.play();
    for( let x=0; x <selectedCards.length; x++){
      selectedCards[x].style.border = 'none';
    }
    selectedCards = [];
    }
}

//adds the clicked on cards to the array of selected cards and verifies them
function addToSelectedCardsArr(){
  cardNodeList.forEach(item => {
  item.addEventListener('click', () => {
    if(selectedCards.length < 3 && !selectedCards.includes(item)){ 
      selectedCards.push(item);
      item.style.border = "2px solid blue";
    }
    if (selectedCards.length == 3){
 console.log(selectedCards);
     verifySet();
    }
    
  });
  



});

}
function haveSameClassShape(element1, element2, element3){
 const classList1 = element1.classList;
  const classList2 = element2.classList;
  const classList3 = element3.classList;
  const classShape1 = classList1[1];
  const classShape2 = classList2[1];
  const classShape3 = classList3[1];
    // Check if the current class exists in the second element's class list
    if ((classShape1 == classShape2 && classShape2== classShape3)) {
       return [true, true]// Found a common class
    }else if(classShape1 != classShape2 && classShape2!= classShape3 && classShape3!=classShape1){
      return [true, false] // all different is the second value
    }
      else{
 return false// No common classes found
    }
  
}
function haveSameClassPattern(element1, element2, element3){
   const classList1 = element1.classList;
  const classList2 = element2.classList;
  const classList3 = element3.classList;
  const classPattern1 = classList1[2];
  const classPattern2 = classList2[2];
  const classPattern3 = classList3[2];
    // Check if the current class exists in the second element's class list
    if (classPattern1 == classPattern2 && classPattern2== classPattern3) {
       return [true, true]// Found a common class
    }else if(classPattern1 != classPattern2 && classPattern2!= classPattern3 && classPattern3!=classPattern1){
       return [true, false]
    }else{
 return false// No common classes found
    }
 
  
}
function haveSameColor(element1, element2, element3){
const color1 = element1.style.getPropertyValue('--this-card-color');
const color2 = element2.style.getPropertyValue('--this-card-color');
const color3 = element3.style.getPropertyValue('--this-card-color');
if (color1 == color2 && color2 == color3){
  return [true, true];
}else if(color1 != color2 && color2 != color3 && color3 != color1){
  return [true, false];
}else{
  return false
}

}
function haveSameNumber(array1, array2, array3){
  let totalDisplay1 = 0;
  let totalDisplay2 = 0;
  let totalDisplay3 = 0;
for (let x=0; x< 3 ; x++){
  if (array1[x].style.display == 'flex'){
    totalDisplay1 +=1;
  }
   if (array2[x].style.display == 'flex'){
    totalDisplay2 +=1;
  }
  if (array3[x].style.display == 'flex'){
    totalDisplay3 +=1;
  }
}
if (totalDisplay1 == totalDisplay2 && totalDisplay2 == totalDisplay3){
  return [true, true];
}else if(totalDisplay1 != totalDisplay2 && totalDisplay2 != totalDisplay3 && totalDisplay3 != totalDisplay1){
  return [true, false];
}
else{
  return false
}
}
// eye functions ----------------------------------------------------------

function googlyEyes (){
// these 4 divs are children in one two and three
const rightEye = document.getElementsByClassName("right eye");
const leftEye =document.getElementsByClassName("left eye");
const leftPupil =document.getElementsByClassName("left pupil");
const rightPupil =document.getElementsByClassName("right pupil"); //html list
document.addEventListener("mousemove", (e) =>{

function updatePupil(eye, pupil){
 
   // get eye position
 const eyeRect = eye.getBoundingClientRect();
 const eyeCenterX = eyeRect.left +eyeRect.width /2;
 const eyeCenterY = eyeRect.top +eyeRect.height /2;
 //get mouse position
  const mouseX = e.clientX;
  const mouseY = e.clientY;

 //console.log(`Viewport Coordinates: X = ${mouseX}, Y = ${mouseY}`);
//caluclate direction vector from eye to the mouse
  const dx = mouseX - eyeCenterX;
  const dy = mouseY- eyeCenterY;
  //calculate distance form eye center to mouse
  const distance = Math.sqrt(dx * dx + dy * dy);
  //normalize vector
   const dirX = dx / distance;
      const dirY = dy / distance;
 
  // calculate the eye radius and max pupil movement
      const eyeRadius = eyeRect.width / 2; // because it should be a square 
      const pupilRadius = 7; // Half of the pupil size (~15px/2)
      const maxMovement = eyeRadius - pupilRadius - 3; // padding of 3px from the eye
     
      //apply the max movement constraint
      //take the min number between desitination and max distance the pupil can travel
     const sensitivity = 1.5;
const moveX = dirX * Math.min(distance * sensitivity, maxMovement);
const moveY = dirY * Math.min(distance * sensitivity, maxMovement);
    
    pupil.style.left = `calc(50% + ${moveX}px)`;
      pupil.style.top = `calc(50% + ${moveY}px)`;
 
}
for (let i = 0; i < rightEye.length; i++) {
  updatePupil(rightEye[i], rightPupil[i]);
}

for (let i = 0; i < leftEye.length; i++) {
  updatePupil(leftEye[i], leftPupil[i]);
}
 })
}

// timer stuff
const quitBtn = document.querySelector("#quit");
let isRunning = false;
let secondsDisplay = document.querySelector("#seconds");
let minutesDisplay = document.querySelector("#minutes");
let hoursDisplay = document.querySelector("#hours");
let startTime;
let timerInterval;
let elapsedTime = 0;
function displayTimer(ms){

  const totalSeconds = Math.floor(ms / 1000);
  const totalMinutes = Math.floor(totalSeconds / 60);
  const totalHours = Math.floor(totalMinutes / 60);

  
  const seconds = totalSeconds % 60;
  const minutes = totalMinutes % 60;
  const hours = totalHours;

  return {
    hours: String(hours),
    minutes: String(minutes),
    seconds: String(seconds)
  };
}
function updateDisplay(){
  const currentTime = Date.now();
  elapsedTime = currentTime - startTime;
  const formatted = displayTimer(elapsedTime);
  
secondsDisplay.innerText = formatted.seconds;
minutesDisplay.innerText = formatted.minutes;
hoursDisplay.innerText = formatted.hours 

}
function startTimer(){
if (!isRunning){
  startTime =Date.now() - elapsedTime;
  timerInterval = setInterval(updateDisplay, 10);
isRunning = true;}
}

function stopTimer(){
  if(isRunning){
    clearInterval(timerInterval);
    isRunning = false;
    console.log(isRunning)
  }
}

// chart stats stuff
const myChart = new Chart(donughtChart,{
  type: "doughnut",
  data: {
    labels: ["Almost identical Sets", "Balanced Sets", "Single Common Trait", "Rainbow"],
    datasets: [
      {
        label: "Type of Set",
        data: [0, 0, 0, 0],
      }
    ]
  },
  options:{
    plugins:{
      legend:{
        display:false,
      },
    },
  },
});
const lastChart = new Chart(endingChart,{
  type: "doughnut",
  data: {
    labels: ["Almost identical Sets", "Balanced Sets", "Single Common Trait", "Rainbow"],
    datasets: [
      {
        label: "Type of Set",
        data: [0, 0, 0, 0],
      }
    ]
  },
  options:{
    plugins:{
      legend:{
        display:false,
      },
    },
  },
});
  //function calls-----------------------------------------------
dealCards();
initial =false;
addToSelectedCardsArr();
googlyEyes();
quitBtn.addEventListener("click", quitting);

 //start of add more cards to DOM
 
  addCardsElement.addEventListener("click", dealCards);
  

